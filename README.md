# О чем репозиторий
Данный репозиторий документирует выполнение [задания](#о-задании) от преподавателя по АКТиОС[^1]. Предыстория получения задания интересная[^2], но не играет роли.

В репозитории находятся [программа](gui%20project/), [прошивка](firmware%20project/) и [журнал выполнения](#журнал), а также документация и другие материалы. 
Журнал будет периодически обновляться, пока не будет закончен проект. 
## Кратко о работе
- :label: Плата: **Arduino Nano** ([документация](/assets/docs/Документация/), [официальный сайт](https://arduino.ru/Hardware/ArduinoBoardNano))
- :label: Микроконтроллер: **ATmega328**(необходим oldbootloader)
- :label: Прошивка микроконтроллера: **C**
- :label: GUI: **Python**
- :label: Разработчики: **[Карась А.С.](https://github.com/anticlown322)**, **[Рычихин С.А.](https://github.com/BeerManNotAvailable1)**
## О задании
### :pushpin: Проблема
Дан элемент памяти, который необходимо протестировать. Элемент памяти кладут в термошкаф, постепенно повышают температуру[^3]. 
Далее начинается тестирование. Тестирование происходит прогонкой через элемент памяти тестов, исходящих из подсоединенной платы.
### :dart: Задача 
При появлении сообщений об ошибках необходимо выводить их с платы на экран. Для этого должен использоваться GUI[^4]. Создать приложение с GUI необходимо на Python. 

Прошивку микроконтроллера на плате необходимо делать в CodeVisionAVR на C[^5].
## Журнал
### :date: 17.10.2023 - 22.10.2023
*Выдача задания.* Были написаны базовые функции и процедуры на Python, которые проверяют, подключено ли какое-либо устройство через виртуальный COM-порт, 
а также позволяют записывать/считывать информацию. Аналогичная была написана [программа на Delphi](assets/docs//Проект%20Delphi/), но забракована из-за неактуальности.
### :date: 23.10.2023 - 26.10.2023
*Выдача платы.* После презентации результатов выдали плату Arduino Nano для дальнейшего развития проекта. Первое, что было необходимо сделать, 
так это установить драйвер для нее(при подключении без необходимого драйвера виртуальный COM-порт не виден, плата также). 

Была сделана простейшая [прошивка](https://github.com/anticlown322/Arduino-Nano/commit/3e12a95fa67c4c6f73506e6b646f7dbea06a7285#diff-7ef08f3cd13f50b2c9488ca1e4dcf51efaf6869c3b73c9067107d1ffd2b8e869) 
с помощью CodeVisionAVR(стандартная для Arduino программа Blink):
```
#include <mega328p.h>
#include <delay.h>

void main(void) {
    int i = 0;
    while(1){                                                                                               
        i = i ^ 1;
        delay_ms(1000);
        PORTB = (i<<PORTB7)|(i<<PORTB6)|(i<<PORTB5)|(i<<PORTB4)|(i<<PORTB3)|(i<<PORTB2)|(i<<PORTB1)|(i<<PORTB0);
    }
}
``` 

Также сделали [прототип GUI](/gui%20project/) для приложения:

![Снимок GUI](assets/images/GUI%20Screenshot.PNG)        
### :date: 27.10.2023 - 31.10.2023
*Доработка и мелкие улучшения.* Никаких серьезных изменений.
### :date: 01.11.2023
*Уточнение задачи.* Рассказали, что делать дальше. Необходимо будет присоединить плату Arduino к общей плате, где уже находится тестируемая память. Так выглядит общая плата:

![Снимок общей платы - лицевая сторона](assets/images/Circuit%20board%201.jpg)        
![Снимок общей платы - обратная сторона](assets/images/Circuit%20board%202.jpg)     

При включении сначала микропроцессор будет посылать последовательности бит, чтобы занулить память(всего 4096 ячеек памяти). Алгоритм следующий:
- 1. Записать подаваемое значение(логический 0 в данном случае).
- 2. Перейти на адрес следующей ячейки памяти по известному смещению[^6].
- 3. Записать в ячейку подаваемое значение.

После зануления в память записываются определенные последовательности битов, определенные тестом. Им ожидаются соответствующие биты, посылаемые памятью обратно. Если пришедшие биты не сходятся с ожидаемыми, 
то начинается отладка. В результате либо исправляются расчеты, либо бит считается битым. 

Необходимо написать программу, реализующую данный алгоритм. Также необходимо исправить GUI под данные требования: выводить состояние памяти в виде большой таблицы из 4096 ячеек, где красными будут выделены 
побитые биты.
### :date: 02.11.2023 - 08.11.2023
*Выдача мультиметра.* Выдали мультиметр[^7] и [даташит](assets/docs/Техническая%20спецификация.pdf) с дополнениями, чтобы мы могли проверить корректность следования подаваемых сигналов. Т.е. при выходе из 
определенного порта микропроцессора сигнал следует к определенному переходнику на плате Arduino и затем к определенному входу памяти(напр., при подаче сигнала в порт PC0 микроконтроллера он следует к 
переходнику A0 и затем к входу памяти А5). 

Для проверки корректности следования сигналов была также выдана таблица, сделанная преподавателем:

![Таблица переходов сигналов](assets/images/Таблица%20переходов.PNG)     

Ошибок в соответствии сигналов микроконтроллера и переходников на данный момент не обнаружено :smile:. Для этого использовали новую [прошивку](https://github.com/anticlown322/Arduino-Nano/commit/9f4befece1901050dfbbb9aa7b572548ba6f2821#diff-7ef08f3cd13f50b2c9488ca1e4dcf51efaf6869c3b73c9067107d1ffd2b8e869).

 Остается еще проверить правильность следования сигналов от платы Arduino по общей плате к памяти.
# Заключение
Что-то о рабском труде

*С уважением, команда проекта*

[^1]: Архитектура компьютерной техники и операционных систем. Дисциплина в [БГУИР](https://www.bsuir.by/)(поток ПОИТ 2022-го года поступления). Преподаватель - [Леванцевич Владимир Александрович](https://www.bsuir.by/ru/kaf-poit/levantsevicha-v-a-publikatsii).
[^2]: Т.к. я(Карась А.С.) пропускал большую часть лекций пропускал, то на этом и попался. 
Пропуски мои были записаны, сулило незавидное будущее. Решил напоследок удивить преподавателя, сделав в [Proteus](https://www.labcenter.com/)'e схему 
с микроконтроллером собственной прошивки(мелкие забавы с выводом на графический экран). 
Это заинтересовало преподавателя, поэтому он и дал уже текущее задание, связанное с тестированием.
[^3]: От комнатной до ок. 50°C 
[^4]: Не консоль, слишком просто :smile:
[^5]: Не Arduino IDE с своим языком, т.к. будет необходимость в контроле на низком уровне(изменение определенных пинов и портов).
[^6]: Для указания адреса используем 12 портов, т.е. адрес задается 12-ю битами.
[^7]: Цифровой мультиметр Mastech M890G.